<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"><link rel="icon" type="image/png" href="/images/cabin.png"><link href="/styles/main.css" rel="stylesheet"><title>How To: Update Futuremap</title><meta name="description" content="Steps required to perform the yearly update for FutureMap"></head><body><nav><h1 class="name"><a href="/" class="logo-ual"></a><a href="/">artslondondev</a></h1><div class="menu icon-menu"></div><ul class="nav-links"><li class="text-link"><a href="/about.html">about</a></li><li class="text-link"><a href="/projects.html">projects</a></li><li class="text-link"><a href="/archives.html">How to ...</a></li></ul><div class="social-media"><a href="https://github.com/artslondon" class="icon-github"></a><a href="https://twitter.com/artslondondev " class="icon-twitter"></a></div></nav><div class="content"><div class="post-head group"><a href="/posts/how-to-update-futuremap/"><h1 class="post-title">How To: Update Futuremap</h1></a><span class="post-date">2014 &#183; 6 &#183; 2</span></div><div class="post-body markdown"><h1><a name="before-updating-anything-on-the-live-site" class="anchor" href="#before-updating-anything-on-the-live-site"><span class="header-link"></span></a>Before Updating anything on the live site</h1>
<p><strong> Before you begin to make any changes to the live site</strong>
Make sure you have an up to date local version of showtime installed on your machine and the latest version of the database downloaded from the live site.</p>
<p>Make the updates on your local copy of showtime first, test and then repeat the steps on the live site once you have tested locally.</p>
<h2><a name="1-setting-up-a-local-copy-of-showtime" class="anchor" href="#1-setting-up-a-local-copy-of-showtime"><span class="header-link"></span></a>1. Setting up a local copy of showtime</h2>
<ol>
<li><p>Download &amp; install sequal pro application for managing databases: <a href="http://www.sequelpro.com/download"><a href="http://www.sequelpro.com/download">http://www.sequelpro.com/download</a></a></p>
</li>
<li><p>Export a copy of the live showtime database from PHPMyAdmin. Save the sql file to your desktop.
URL for showtime PHPMyAdmin: <a href="https://web-ip1.arts.local:8443/phpmyadmin"><a href="https://web-ip1.arts.local:8443/phpmyadmin">https://web-ip1.arts.local:8443/phpmyadmin</a></a></p>
</li>
<li><p>Log in to your localhost PHPMyAdmin using <a href="http://localhost/phpMyAdmin/"><a href="http://localhost/phpMyAdmin/">http://localhost/phpMyAdmin/</a></a></p>
</li>
<li><p>Create a new local database, called &quot;arts_uploader&quot;.</p>
</li>
<li><p>Create a user for the <em>arts_uploader</em> database called &quot;testuser&quot; and password set to &quot;test&quot;. Set the user to have &quot;all privilidges&quot; access on the database. <strong>Hosts</strong> - set to &quot;localhost&quot;.</p>
</li>
<li><p>Use the sequel Pro app to connect to your local arts_uploader database and import the SQL file you downloaded in step 2.</p>
</li>
</ol>
<h2><a name="2-updating-student-profiles-to-use-futuremap-page-template" class="anchor" href="#2-updating-student-profiles-to-use-futuremap-page-template"><span class="header-link"></span></a>2. Updating student profiles to use Futuremap page template</h2>
<p>For each student that you are adding to the Futuremap for this year, you will need to update their record in the showtime databse. </p>
<p><strong> How To: </strong></p>
<h3><a name="part-a-add-a-new-year-to-futuremap-specialtheme-table" class="anchor" href="#part-a-add-a-new-year-to-futuremap-specialtheme-table"><span class="header-link"></span></a>Part A - Add a new year to futuremap specialtheme table</h3>
<ol>
<li><p>Open your local PHPMyAdmin <a href="http://localhost/phpMyAdmin/"><a href="http://localhost/phpMyAdmin/">http://localhost/phpMyAdmin/</a></a></p>
</li>
<li><p>Go to the &#39;specialtheme&#39; table. Insert a new row for the current year. Take note of the ID. (used in part B - below)</p>
</li>
</ol>
<h3><a name="part-b-update-each-students-profile-in-the-database" class="anchor" href="#part-b-update-each-students-profile-in-the-database"><span class="header-link"></span></a>Part B - Update each student&#39;s profile in the database</h3>
<ol>
<li><p>open local PHPMyAdmin</p>
</li>
<li><p>Click to view the &quot;student&quot; table. (click the table name in the left sidebar)</p>
</li>
<li><p>Select the &quot;search&quot; tab and do a search on the &quot;ProfileName&quot; field for the student you want to add to futuremap. Example if you are searching for the profile for &quot;abigail smith&quot;, you would enter &quot;abigailsmith&quot; (<em>no space between first and lastname</em>) in the ProfileName field in search. 
Make sure you set the search &quot;operator&quot; to &quot;=&quot; to find an exact match. Click &quot;go&quot; and you should see the student entry in the database.</p>
</li>
<li><p>Edit the student entry - change the <strong>specialtheme_id</strong> field to the number that corresponds to the year you are adding. This should update their profile to use the futuremap theme.  </p>
</li>
</ol>
<p>Example. 
For year 2013. Futuremap 2013 specialtheme_id = 6, so each student row in the database should have the special theme_id field updated to &#39;6&#39;</p>
<ol>
<li><p>To test, navigate to <a href="http://localhost/showtime/studentname">http://localhost/showtime/studentname</a> in your browser. You should see the student profile using the futuremap layout.</p>
</li>
<li><p>Repeat for each student you want to add to futuremap.</p>
</li>
</ol>
<h3><a name="part-c-update-showtime-php-files" class="anchor" href="#part-c-update-showtime-php-files"><span class="header-link"></span></a>Part C - Update showtime php files</h3>
<ol>
<li><p>Clone the showtime repo from Github. <a href="https://github.com/artslondon/Showtime"><a href="https://github.com/artslondon/Showtime">https://github.com/artslondon/Showtime</a></a></p>
<ul>
<li>to clone, run <code>git clone https://github.com/artslondon/Showtime.git</code> from within terminal.</li>
</ul>
</li>
<li><p>Open up the folder you cloned from git in your text editor.(sublime text or equivalent)</p>
</li>
<li><p>Open <strong>app/controllers/media_controller.php</strong>.  Edit from line 216, example code below:</p>
</li>
</ol>
<pre><code class="lang-php"><div class="highlight"><pre><span class="x">    case &quot;futuremap&quot;:</span>
<span class="x">        if (!empty($params[&#39;year&#39;])) {</span>
<span class="x">            if ($params[&#39;year&#39;] == &quot;2013&quot;) {                    </span>
<span class="x">                $special_filter[&#39;Student.specialtheme_id&#39;] = 6;</span>
<span class="x">            } else if ($params[&#39;year&#39;] == &quot;2012&quot;) {</span>
<span class="x">                $special_filter[&#39;Student.specialtheme_id&#39;] = 5;</span>
<span class="x">            } else if ($params[&#39;year&#39;] == &quot;2011&quot;) {</span>
<span class="x">                $special_filter[&#39;Student.specialtheme_id&#39;] = 4;</span>
<span class="x">            } else if ($params[&#39;year&#39;] == &quot;2010&quot;) {</span>
<span class="x">                $special_filter[&#39;Student.specialtheme_id&#39;] = 3;</span>
<span class="x">            } else if ($params[&#39;year&#39;] == &quot;2009&quot;) {</span>
<span class="x">                $special_filter[&#39;Student.specialtheme_id&#39;] = 1;</span>
<span class="x">            } else {</span>
<span class="x">                $special_filter[&#39;Student.specialtheme_id&#39;] = 99;</span>
<span class="x">            }</span>
<span class="x">        }</span>
<span class="x">        else {</span>
<span class="x">            $special_filter[] = &quot;(Student.specialtheme_id = &#39;6&#39;)&quot;;</span>
<span class="x">        }</span>
<span class="x">        $this-&gt;paginate[&#39;limit&#39;] =80;</span>
<span class="x">        break;</span>
<span class="x">        }</span>
</pre></div>
</code></pre>
<p>Add a new if statement and increment specialtheme_id to the code block above for the year that you are adding. </p>
<p><strong>Example</strong> </p>
<p>For 2014, you would add the following code to the block above.  </p>
<pre><code class="lang-php"><div class="highlight"><pre><span class="x">    if ($params[&#39;year&#39;] == &quot;2014&quot;) {                    </span>
<span class="x">        $special_filter[&#39;Student.specialtheme_id&#39;] = 7;</span>
<span class="x">    }</span>
</pre></div>
</code></pre>
<ol>
<li>from the same media_controller.php file, change this line:</li>
</ol>
<pre><code class="lang-php"><div class="highlight"><pre><span class="x">    $special_filter[] = &quot;(Student.specialtheme_id = &#39;6&#39;)&quot;;&#39;</span>
</pre></div>
</code></pre>
<p>To use your new specialtheme_id</p>
<p><strong>Example</strong> </p>
<p>For 2014, the updated line would read: </p>
<pre><code class="lang-php"><div class="highlight"><pre><span class="x">    $special_filter[] = &quot;(Student.specialtheme_id = &#39;7&#39;)&quot;;</span>
</pre></div>
</code></pre>
<h2><a name="3-repeat-changes-on-the-live-site" class="anchor" href="#3-repeat-changes-on-the-live-site"><span class="header-link"></span></a>3. Repeat changes on the live site</h2>
<p>After completing steps 1 and 2 on your local showtime install, repeat for the live site by making changes to the live files and database.</p>
<ol>
<li><p>Showtime live PHPMyAdmin: <a href="https://web-ip1.arts.local:8443/phpmyadmin/"><a href="https://web-ip1.arts.local:8443/phpmyadmin/">https://web-ip1.arts.local:8443/phpmyadmin/</a></a></p>
<ul>
<li>if you do not have an admin login for showtime, you will need to request one or use an existing login.</li>
</ul>
</li>
<li><p>update Showtime php files:  (see part ### Part C - 3. from above) copy the modified php file to the live server.</p>
</li>
</ol>
</div><!-- Social sharing icons--><div class="social"><a href="https://twitter.com/share" class="twitter-share-button">Tweet</a><div data-size="medium" data-annotation="bubble" data-width="300" class="g-plusone"></div><a href="http://news.ycombinator.com/submit" class="hn-share-button">Vote on HN</a></div><!-- Disqus comments, Make sure to replace `colinwren` with your account name in the Disqus helper script below--><div id="comments"><div id="disqus_thread"></div></div><!-- Helper scripts for social share icons--><!-- Hacker News--><script type="text/javascript">(function(d, t) {
  var g = d.createElement(t),
      s = d.getElementsByTagName(t)[0];
  g.src = '//hnbutton.appspot.com/static/hn.min.js';
  s.parentNode.insertBefore(g, s);
}(document, 'script'));
</script><!-- Twitter--><script type="text/javascript">!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");
</script><!-- Google Plus--><script type="text/javascript">(function() {
  var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
  po.src = 'https://apis.google.com/js/plusone.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
})();
</script><!-- Disqus--><script type="text/javascript">var disqus_shortname = 'artslondon'; // Change this to your Disqus account name

(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script></div><script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js" type="text/javascript"></script><script src="/scripts/main.js" type="text/javascript"></script><script>// Add your analytics code here</script></body></html>