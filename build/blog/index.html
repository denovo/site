<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"><link rel="icon" type="image/png" href="/images/cabin.png"><link href="/styles/main.css" rel="stylesheet"><title>artslondondev blog</title></head><body><nav><h1 class="name"><a href="/" class="logo-ual"></a><a href="/">artslondondev</a></h1><div class="menu icon-menu"></div><ul class="nav-links"><li class="text-link"><a href="/about.html">about</a></li><li class="text-link"><a href="/projects.html">projects</a></li><li class="text-link"><a href="/archives.html">How to ...</a></li></ul><div class="social-media"><a href="https://github.com/artslondon" class="icon-github"></a><a href="https://twitter.com/artslondondev " class="icon-twitter"></a></div></nav><div class="content"><div class="post-head group"><a href="/posts/how-to-import-new-students-into-showtime-annual-update/"><h1 class="post-title">How to: Import new students into showtime (annual update) </h1></a><span class="post-date">2014 &#183; 7 &#183; 2</span></div><div class="post-body markdown"><h1><a name="import-records-into-showtime-db" class="anchor" href="#import-records-into-showtime-db"><span class="header-link"></span></a>Import records into Showtime db</h1>
<h2><a name="part-1-data-preparation-and-local-testing" class="anchor" href="#part-1-data-preparation-and-local-testing"><span class="header-link"></span></a>Part 1: Data preparation and local testing</h2>
<ul>
<li>Acquire new year cohort from Stephen Petty in Academic Registry</li>
<li>Save excel file as .csv format</li>
<li>Check the file in a text editor to see that it has column headings and that each row starts a new line</li>
<li>Test the import script locally at /admin/import</li>
<li>Extract the column headings and the first line into a separate file, to be used for testing</li>
<li>If your import script is &gt; 1500 lines, split it into separate files e.g. import01.csv, import02.csv</li>
</ul>
<h2><a name="part-2-prepare-the-live-environment" class="anchor" href="#part-2-prepare-the-live-environment"><span class="header-link"></span></a>Part 2: Prepare the live environment</h2>
<ul>
<li>Advise IT (Phil Haines, Gerry Hickman) that you are planning to import data into the Showtime db</li>
<li>Put up a warning notice on Showtime (use the default and admin layout views) at least half a day in advance</li>
<li>Log in to Showtime using an admin user account and navigate to showtime.arts.ac.uk/admin/import</li>
<li>Modify app/config/routes.php, commenting out the entire file except a) the ‘Maintenance / downtime’ route at the bottom and b) the two ‘admin’ route lines, so that you can run the importer</li>
<li>Deploy routes.php to put the site into maintenance mode</li>
<li>Log in to PHPMyAdmin for the arts_uploader database (for logins see Website General &gt; Writeboards)</li>
<li>Export/backup the complete arts_uploader db in case things go wrong</li>
</ul>
<h2><a name="part-3-run-the-importer" class="anchor" href="#part-3-run-the-importer"><span class="header-link"></span></a>Part 3: Run the importer</h2>
<ul>
<li>Start by running your 1-line test .csv file in preview mode, then try it in import mode</li>
<li>Check that the enrolment ID you imported has been inserted into the database</li>
<li>Import each of your csv files in turn until complete</li>
</ul>
<h2><a name="note-importer-options" class="anchor" href="#note-importer-options"><span class="header-link"></span></a>Note: Importer options</h2>
<p>When running the import for the 2013 cohort, I checked ‘Create new courses’ and ‘Update profiles’ and ‘Update active accounts’ (and all its sub-options). This means that students with existing accounts who have graduated and enrolled on a different course, potentially at a different college, will have their details updated without being told in advance.</p>
<p>While there might be a few cases where students don’t want existing work (from an older course) to be associated with a new course, on balance it’s better to reduce day-to-day Showtime admin where students request their college or graduation year to be updated.</p>
</div><div class="comments"><a href="/posts/how-to-import-new-students-into-showtime-annual-update/#comments"><span class="icon-bubbles"></span>Comments</a></div><div class="post-head group"><a href="/posts/how-to-update-futuremap/"><h1 class="post-title">How To: Update Futuremap</h1></a><span class="post-date">2014 &#183; 6 &#183; 2</span></div><div class="post-body markdown"><h1><a name="before-updating-anything-on-the-live-site" class="anchor" href="#before-updating-anything-on-the-live-site"><span class="header-link"></span></a>Before Updating anything on the live site</h1>
<p><strong> Before you begin to make any changes to the live site</strong>
Make sure you have an up to date local version of showtime installed on your machine and the latest version of the database downloaded from the live site.</p>
<p>Make the updates on your local copy of showtime first, test and then repeat the steps on the live site once you have tested locally.</p>
<h2><a name="1-setting-up-a-local-copy-of-showtime" class="anchor" href="#1-setting-up-a-local-copy-of-showtime"><span class="header-link"></span></a>1. Setting up a local copy of showtime</h2>
<ol>
<li><p>Download &amp; install sequal pro application for managing databases: <a href="http://www.sequelpro.com/download"><a href="http://www.sequelpro.com/download">http://www.sequelpro.com/download</a></a></p>
</li>
<li><p>Export a copy of the live showtime database from PHPMyAdmin. Save the sql file to your desktop.
URL for showtime PHPMyAdmin: <a href="https://web-ip1.arts.local:8443/phpmyadmin"><a href="https://web-ip1.arts.local:8443/phpmyadmin">https://web-ip1.arts.local:8443/phpmyadmin</a></a></p>
</li>
<li><p>Log in to your localhost PHPMyAdmin using <a href="http://localhost/phpMyAdmin/"><a href="http://localhost/phpMyAdmin/">http://localhost/phpMyAdmin/</a></a></p>
</li>
<li><p>Create a new local database, called &quot;arts_uploader&quot;.</p>
</li>
<li><p>Create a user for the <em>arts_uploader</em> database called &quot;testuser&quot; and password set to &quot;test&quot;. Set the user to have &quot;all privilidges&quot; access on the database. <strong>Hosts</strong> - set to &quot;localhost&quot;.</p>
</li>
<li><p>Use the sequel Pro app to connect to your local arts_uploader database and import the SQL file you downloaded in step 2.</p>
</li>
</ol>
<h2><a name="2-updating-student-profiles-to-use-futuremap-page-template" class="anchor" href="#2-updating-student-profiles-to-use-futuremap-page-template"><span class="header-link"></span></a>2. Updating student profiles to use Futuremap page template</h2>
<p>For each student that you are adding to the Futuremap for this year, you will need to update their record in the showtime databse. </p>
<p><strong> How To: </strong></p>
<h3><a name="part-a-add-a-new-year-to-futuremap-specialtheme-table" class="anchor" href="#part-a-add-a-new-year-to-futuremap-specialtheme-table"><span class="header-link"></span></a>Part A - Add a new year to futuremap specialtheme table</h3>
<ol>
<li><p>Open your local PHPMyAdmin <a href="http://localhost/phpMyAdmin/"><a href="http://localhost/phpMyAdmin/">http://localhost/phpMyAdmin/</a></a></p>
</li>
<li><p>Go to the &#39;specialtheme&#39; table. Insert a new row for the current year. Take note of the ID. (used in part B - below)</p>
</li>
</ol>
<h3><a name="part-b-update-each-students-profile-in-the-database" class="anchor" href="#part-b-update-each-students-profile-in-the-database"><span class="header-link"></span></a>Part B - Update each student&#39;s profile in the database</h3>
<ol>
<li><p>open local PHPMyAdmin</p>
</li>
<li><p>Click to view the &quot;student&quot; table. (click the table name in the left sidebar)</p>
</li>
<li><p>Select the &quot;search&quot; tab and do a search on the &quot;ProfileName&quot; field for the student you want to add to futuremap. Example if you are searching for the profile for &quot;abigail smith&quot;, you would enter &quot;abigailsmith&quot; (<em>no space between first and lastname</em>) in the ProfileName field in search. 
Make sure you set the search &quot;operator&quot; to &quot;=&quot; to find an exact match. Click &quot;go&quot; and you should see the student entry in the database.</p>
</li>
<li><p>Edit the student entry - change the <strong>specialtheme_id</strong> field to the number that corresponds to the year you are adding. This should update their profile to use the futuremap theme.  </p>
</li>
</ol>
<p>Example. 
For year 2013. Futuremap 2013 specialtheme_id = 6, so each student row in the database should have the special theme_id field updated to &#39;6&#39;</p>
<ol>
<li><p>To test, navigate to <a href="http://localhost/showtime/studentname">http://localhost/showtime/studentname</a> in your browser. You should see the student profile using the futuremap layout.</p>
</li>
<li><p>Repeat for each student you want to add to futuremap.</p>
</li>
</ol>
<h3><a name="part-c-update-showtime-php-files" class="anchor" href="#part-c-update-showtime-php-files"><span class="header-link"></span></a>Part C - Update showtime php files</h3>
<ol>
<li><p>Clone the showtime repo from Github. <a href="https://github.com/artslondon/Showtime"><a href="https://github.com/artslondon/Showtime">https://github.com/artslondon/Showtime</a></a></p>
<ul>
<li>to clone, run <code>git clone https://github.com/artslondon/Showtime.git</code> from within terminal.</li>
</ul>
</li>
<li><p>Open up the folder you cloned from git in your text editor.(sublime text or equivalent)</p>
</li>
<li><p>Open <strong>app/controllers/media_controller.php</strong>.  Edit from line 216, example code below:</p>
</li>
</ol>
<pre><code class="lang-php"><div class="highlight"><pre><span class="x">    case &quot;futuremap&quot;:</span>
<span class="x">        if (!empty($params[&#39;year&#39;])) {</span>
<span class="x">            if ($params[&#39;year&#39;] == &quot;2013&quot;) {                    </span>
<span class="x">                $special_filter[&#39;Student.specialtheme_id&#39;] = 6;</span>
<span class="x">            } else if ($params[&#39;year&#39;] == &quot;2012&quot;) {</span>
<span class="x">                $special_filter[&#39;Student.specialtheme_id&#39;] = 5;</span>
<span class="x">            } else if ($params[&#39;year&#39;] == &quot;2011&quot;) {</span>
<span class="x">                $special_filter[&#39;Student.specialtheme_id&#39;] = 4;</span>
<span class="x">            } else if ($params[&#39;year&#39;] == &quot;2010&quot;) {</span>
<span class="x">                $special_filter[&#39;Student.specialtheme_id&#39;] = 3;</span>
<span class="x">            } else if ($params[&#39;year&#39;] == &quot;2009&quot;) {</span>
<span class="x">                $special_filter[&#39;Student.specialtheme_id&#39;] = 1;</span>
<span class="x">            } else {</span>
<span class="x">                $special_filter[&#39;Student.specialtheme_id&#39;] = 99;</span>
<span class="x">            }</span>
<span class="x">        }</span>
<span class="x">        else {</span>
<span class="x">            $special_filter[] = &quot;(Student.specialtheme_id = &#39;6&#39;)&quot;;</span>
<span class="x">        }</span>
<span class="x">        $this-&gt;paginate[&#39;limit&#39;] =80;</span>
<span class="x">        break;</span>
<span class="x">        }</span>
</pre></div>
</code></pre>
<p>Add a new if statement and increment specialtheme_id to the code block above for the year that you are adding. </p>
<p><strong>Example</strong> </p>
<p>For 2014, you would add the following code to the block above.  </p>
<pre><code class="lang-php"><div class="highlight"><pre><span class="x">    if ($params[&#39;year&#39;] == &quot;2014&quot;) {                    </span>
<span class="x">        $special_filter[&#39;Student.specialtheme_id&#39;] = 7;</span>
<span class="x">    }</span>
</pre></div>
</code></pre>
<ol>
<li>from the same media_controller.php file, change this line:</li>
</ol>
<pre><code class="lang-php"><div class="highlight"><pre><span class="x">    $special_filter[] = &quot;(Student.specialtheme_id = &#39;6&#39;)&quot;;&#39;</span>
</pre></div>
</code></pre>
<p>To use your new specialtheme_id</p>
<p><strong>Example</strong> </p>
<p>For 2014, the updated line would read: </p>
<pre><code class="lang-php"><div class="highlight"><pre><span class="x">    $special_filter[] = &quot;(Student.specialtheme_id = &#39;7&#39;)&quot;;</span>
</pre></div>
</code></pre>
<h2><a name="3-repeat-changes-on-the-live-site" class="anchor" href="#3-repeat-changes-on-the-live-site"><span class="header-link"></span></a>3. Repeat changes on the live site</h2>
<p>After completing steps 1 and 2 on your local showtime install, repeat for the live site by making changes to the live files and database.</p>
<ol>
<li><p>Showtime live PHPMyAdmin: <a href="https://web-ip1.arts.local:8443/phpmyadmin/"><a href="https://web-ip1.arts.local:8443/phpmyadmin/">https://web-ip1.arts.local:8443/phpmyadmin/</a></a></p>
<ul>
<li>if you do not have an admin login for showtime, you will need to request one or use an existing login.</li>
</ul>
</li>
<li><p>update Showtime php files:  (see part ### Part C - 3. from above) copy the modified php file to the live server.</p>
</li>
</ol>
</div><div class="comments"><a href="/posts/how-to-update-futuremap/#comments"><span class="icon-bubbles"></span>Comments</a></div><div class="post-head group"><a href="/posts/how-to-upload-virtual-tours/"><h1 class="post-title">How To: Upload Virtual Tours</h1></a><span class="post-date">2014 &#183; 1 &#183; 17</span></div><div class="post-body markdown"><h2><a name="virtual-tours" class="anchor" href="#virtual-tours"><span class="header-link"></span></a>Virtual Tours</h2>
<p><strong>This will shw you how to upload virtual tour files onto the arts.ac.uk website using site manager</strong></p>
<p><a href="https://www.dropbox.com/sh/3n34d7kdpe1c5ua/i6cbMfN5Eh/Resources?lst#lh:null-virtual-tours-screen-web%20-%20Broadband.m4v">https://www.dropbox.com/sh/3n34d7kdpe1c5ua/i6cbMfN5Eh/Resources?lst#lh:null-virtual-tours-screen-web%20-%20Broadband.m4v</a></p>
</div><div class="comments"><a href="/posts/how-to-upload-virtual-tours/#comments"><span class="icon-bubbles"></span>Comments</a></div><div class="pagination group"></div></div><script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js" type="text/javascript"></script><script src="/scripts/main.js" type="text/javascript"></script><script>// Add your analytics code here</script></body></html>